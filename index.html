<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>International Phone Number Generator | Free Contact Export Tool</title>

  <!-- SEO, Open Graph, Twitter, Schema.org tags remain the same -->

  <style>
    /* Existing CSS remains the same */

    /* New Styles for Progress Bar */
    .progress-bar {
      width: 100%;
      background: #f0f0f0;
      border-radius: 5px;
      margin: 10px 0;
      overflow: hidden;
    }
    .progress {
      height: 20px;
      background: var(--button);
      width: 0%;
      transition: width 0.3s;
      text-align: center;
      color: var(--button-text);
      line-height: 20px;
    }

    /* New Styles for Preview */
    #previewSection {
      margin-top: 20px;
      display: none;
      padding: 15px;
      background: var(--card);
      border-radius: 4px;
    }
    #previewToggle {
      margin: 10px 0;
      padding: 8px;
      background: var(--button);
      color: var(--button-text);
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    /* New Styles for Feedback Form */
    #feedbackModal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
    }
    #feedbackContent {
      background: var(--card);
      margin: 15% auto;
      padding: 20px;
      width: 80%;
      max-width: 500px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    #feedbackForm textarea, #feedbackForm button {
      width: 100%;
      margin: 10px 0;
      padding: 8px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    #closeFeedback {
      float: right;
      cursor: pointer;
      color: var(--text);
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>International Phone Number Generator</h1>
    <!-- Theme and Customization Controls remain the same -->

    <form id="generatorForm">
      <!-- Existing fields (country, count, format) remain the same -->

      <!-- New: Advanced Formatting Options -->
      <label>
        Number Format
        <span class="info-icon" data-tooltip="Choose how numbers should be formatted.">ℹ️</span>
      </label>
      <div class="radio-group">
        <label><input type="radio" name="numberFormat" value="plain" checked> Plain (1234567890)</label>
        <label><input type="radio" name="numberFormat" value="dashes"> Dashes (123-456-7890)</label>
        <label><input type="radio" name="numberFormat" value="spaces"> Spaces (123 456 7890)</label>
        <label><input type="radio" name="numberFormat" value="parentheses"> Parentheses ((123) 456-7890)</label>
      </div>

      <!-- Generate Button -->
      <button type="submit">Generate & Preview</button>
    </form>

    <!-- New: Preview Section -->
    <button id="previewToggle" style="display: none;">Toggle Preview</button>
    <div id="previewSection">
      <h3>Preview of Generated Numbers</h3>
      <pre id="previewContent"></pre>
      <button id="downloadBtn" style="display: none;">Download Now</button>
    </div>

    <!-- Updated Progress Indicator (Progress Bar) -->
    <div id="progressIndicator">
      <div class="progress-bar">
        <div class="progress" id="progress"></div>
      </div>
      Generating contacts... <span id="progressText">0%</span>
    </div>

    <!-- Notification remains the same -->

    <!-- New: Feedback Button -->
    <button id="openFeedback" style="margin-top: 20px;">Provide Feedback</button>

    <!-- New: Feedback Modal -->
    <div id="feedbackModal">
      <div id="feedbackContent">
        <span id="closeFeedback">&times;</span>
        <h3>Provide Feedback</h3>
        <form id="feedbackForm">
          <textarea id="feedbackText" rows="4" placeholder="Your feedback or suggestions..."></textarea>
          <button type="submit">Submit</button>
        </form>
      </div>
    </div>
  </div>

  <script>
    // Existing phoneGenerators object, updated with more countries
    const phoneGenerators = {
      "+1": function() { /* USA/Canada logic remains the same */ },
      "+91": function() { /* India logic remains the same */ },
      "+44": function() { /* UK logic remains the same */ },
      "+61": function() { /* Australia logic remains the same */ },
      "+49": function() { /* Germany logic remains the same */ },
      "+33": function() { /* France logic remains the same */ },
      "+55": function() { /* Brazil logic remains the same */ },
      "+81": function() { // Japan: 10 digits, starts with 0, but we drop it for international
        let num = "90"; // Common mobile prefix
        for (let i = 0; i < 8; i++) {
          num += Math.floor(Math.random() * 10).toString();
        }
        return num;
      },
      "+86": function() { // China: 11 digits, starts with 1
        let num = "1";
        for (let i = 0; i < 10; i++) {
          num += Math.floor(Math.random() * 10).toString();
        }
        return num;
      },
      "+7": function() { // Russia: 10 digits, starts with 9
        let num = "9";
        for (let i = 0; i < 9; i++) {
          num += Math.floor(Math.random() * 10).toString();
        }
        return num;
      },
      "+27": function() { // South Africa: 9 digits, starts with 6, 7, 8
        let num = ["6", "7", "8"][Math.floor(Math.random() * 3)];
        for (let i = 0; i < 8; i++) {
          num += Math.floor(Math.random() * 10).toString();
        }
        return num;
      }
    };

    // Update countryCode select in HTML
    document.getElementById("countryCode").innerHTML += `
      <option value="+81">+81 (Japan)</option>
      <option value="+86">+86 (China)</option>
      <option value="+7">+7 (Russia)</option>
      <option value="+27">+27 (South Africa)</option>
    `;

    // New function to format numbers
    function formatNumber(number, format) {
      switch(format) {
        case "dashes":
          return number.match(/.{1,3}/g).join("-");
        case "spaces":
          return number.match(/.{1,3}/g).join(" ");
        case "parentheses":
          return "(" + number.slice(0,3) + ") " + number.slice(3,6) + "-" + number.slice(6);
        default:
          return number;
      }
    }

    // Updated createFileContent to include formatting
    function createFileContent(countryCode, count, format, numberFormat) {
      let content = "";
      const generateNumber = phoneGenerators[countryCode] || defaultGenerator;
      
      if (format === "txt") {
        for (let i = 1; i <= count; i++) {
          const phoneNumber = countryCode + generateNumber();
          const formattedNumber = formatNumber(phoneNumber, numberFormat);
          content += `Contact ${i}: ${formattedNumber}\n`;
        }
      } else if (format === "vcf") {
        for (let i = 1; i <= count; i++) {
          const phoneNumber = countryCode + generateNumber();
          const formattedNumber = formatNumber(phoneNumber, numberFormat);
          content += "BEGIN:VCARD\n";
          content += "VERSION:3.0\n";
          content += `FN:Contact ${i}\n`;
          content += `TEL;TYPE=CELL:${formattedNumber}\n`;
          content += "END:VCARD\n\n";
        }
      } else if (format === "csv") {
        content = "Contact,Phone Number\n";
        for (let i = 1; i <= count; i++) {
          const phoneNumber = countryCode + generateNumber();
          const formattedNumber = formatNumber(phoneNumber, numberFormat);
          content += `"Contact ${i}","${formattedNumber}"\n`;
        }
      } else if (format === "json") {
        let contacts = [];
        for (let i = 1; i <= count; i++) {
          const phoneNumber = countryCode + generateNumber();
          const formattedNumber = formatNumber(phoneNumber, numberFormat);
          contacts.push({ contact: `Contact ${i}`, phoneNumber: formattedNumber });
        }
        content = JSON.stringify(contacts, null, 2);
      }
      return content;
    }

    // Updated handle form submission to show preview
    document.getElementById("generatorForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const countValue = parseInt(countInput.value, 10);
      if (isNaN(countValue) || countValue < 1 || countValue > 1000) {
        countError.textContent = "Please enter a valid number between 1 and 1000.";
        return;
      }

      const countryCode = document.getElementById("countryCode").value;
      const format = document.querySelector('input[name="format"]:checked').value;
      const numberFormat = document.querySelector('input[name="numberFormat"]:checked').value;

      const progress = document.getElementById("progressIndicator");
      const progressBar = document.getElementById("progress");
      const progressText = document.getElementById("progressText");
      progress.style.display = "block";
      let progressValue = 0;

      const startTime = performance.now();
      setTimeout(() => {
        const numbers = [];
        for (let i = 0; i < countValue; i++) {
          const phoneNumber = countryCode + (phoneGenerators[countryCode] || defaultGenerator)();
          numbers.push(formatNumber(phoneNumber, numberFormat));
          progressValue = ((i + 1) / countValue) * 100;
          progressBar.style.width = progressValue + "%";
          progressText.textContent = Math.round(progressValue) + "%";
        }

        progress.style.display = "none";
        const previewContent = document.getElementById("previewContent");
        previewContent.textContent = numbers.join("\n");
        document.getElementById("previewSection").style.display = "block";
        document.getElementById("previewToggle").style.display = "block";
        document.getElementById("downloadBtn").style.display = "block";

        const elapsed = ((performance.now() - startTime) / 1000).toFixed(2);
        const notification = document.getElementById("notification");
        notification.textContent = `Preview generated ${countValue} contacts in ${elapsed} seconds.`;
        notification.style.display = "block";
        setTimeout(() => notification.style.display = "none", 5000);

        // Download handler
        document.getElementById("downloadBtn").addEventListener("click", () => {
          const content = createFileContent(countryCode, countValue, format, numberFormat);
          downloadFile("contacts." + format, content);
        });

      }, 500);
    });

    // Preview toggle
    document.getElementById("previewToggle").addEventListener("click", () => {
      const previewSection = document.getElementById("previewSection");
      if (previewSection.style.display === "block") {
        previewSection.style.display = "none";
      } else {
        previewSection.style.display = "block";
      }
    });

    // Feedback Modal
    document.getElementById("openFeedback").addEventListener("click", () => {
      document.getElementById("feedbackModal").style.display = "block";
    });

    document.getElementById("closeFeedback").addEventListener("click", () => {
      document.getElementById("feedbackModal").style.display = "none";
    });

    document.getElementById("feedbackForm").addEventListener("submit", (e) => {
      e.preventDefault();
      const feedback = document.getElementById("feedbackText").value;
      console.log("Feedback submitted:", feedback);
      alert("Thank you for your feedback!");
      document.getElementById("feedbackModal").style.display = "none";
      document.getElementById("feedbackText").value = "";
    });

    // Existing theme, font size, and layout controls remain the same
  </script>
</body>
</html>
